# Word 压缩


应老师要求，把一个 30 多 MB 的 Word 文件压缩到 5MB 以内。一番探索，得出一套通过批量压缩 Word 中图片，以压缩 Word 的方案，记录于此。

<!--more-->

**精简版：**

1. **初步压缩：** 打开 Word，任选一张图片->点菜单栏上`格式`->左侧`压缩图片`->去掉勾选`仅应用于此图片`，勾选 `96 ppi`，点`确定`，保存文件；
2. **提取图片：** 把 Word 文件后缀 `docx` 改成 `zip`，然后解压，解压文件夹下路径 word/media 里就是所有的图片了；
3. **批量压缩：** 打开[iloveimg](https://www.iloveimg.com/zh-cn/compress-image) 批量压缩图片，一次最多 30 张，下载并替换本地图片；
4. **恢复 Word：** 把 word/media 下的图片替换成压缩后的图片，然后把整个文件夹压缩成 Zip，再把后缀 Zip 改回 docx 即可。

**啰嗦版↓**

### 需求评估

#### 需求

现在 10 点，将这个 Word 文件压缩至 5M 以下，12 点前返回。💔

#### 原材料

所给文件是 `docx` 格式的 Word 文档，总大小 35MB；内含 73 张 `png` 格式截图，每张图占满一页；截图是期刊论文的首页截图，文字内容小且多，要尽量保证清晰。

上个全景图看看😲

<div align="center"><img src="https://i.loli.net/2021/08/20/RNfZVojaKEkx4Py.png" alt="20210820214122" width="600" align="center"/></div>


#### 分析与准备

时间紧，任务重，得高效解决。初步分析，涉及三点：

- **压缩：** 由于文件内文字不多，首先忽略文字占用。那么总共 73 张图片，平均每张图片就得压缩至 68KB 以下。压缩图片来说，倒是有很多网站可以做到的，厉害点的还可以自由调整压缩比、分辨率等。

- **批量：** 压缩能解决了，但文件太多，不可能一张一张的去压缩再替换，既耗时又低效。这种重复工作一定要一定要批量处理。所幸 [iloveimg](https://www.iloveimg.com/zh-cn/compress-image) 这个网站也是支持批量处理的，只不过一次处理最多 30 张图片，73张图片处理3次，可以接受。

- **Word图片导出：** 既然**批量**和**压缩**都能解决了，但图片还都在 Word 里面呢，总不能一张一张**另存为**吧。工具软件或者 Word 插件当然是有的，批量提取 Word 中的图片，但一个更朴素的方法当然是 **解压 Word 文件** 😄。因为 `docx`格式的 Word 文档基于 OpenXML 标准，而这个标准是基于 `Zip` 压缩格式的。

### 压缩方案

1. **初步压缩：** 先打开 Word，随便选定一张图片，点菜单栏最后的格式栏，点击左侧压缩图片，去掉勾选 仅应用于此图片，勾选 电子邮件 (96 ppi) 的分辨率，点确定，记得保存修改。

2. **提取图片：** 把 Word 文件后缀 .docx 改成 zip，然后解压，解压后的文件夹里路径 word/media 下就是所有的图片了；

3. **批量压缩：** 用这个网页工具 [iloveimg](https://www.iloveimg.com/zh-cn/compress-image) 批量压缩图片，一次最多 30 张图片。一般直接能压缩到 100k 以下，但如果压缩后还是太大，可以再次上传压缩；

4. **恢复 Word：** 把 word/media 下的所有图片替换成压缩后的图片，然后把整个文件夹压缩成 zip 格式，再把后缀 zip 改回 docx 即可。

5. **转 pdf：** Word 转成 pdf，最好是用 adobe（1. Word 上右键菜单里转换为 Adobe PDF 文件，2. 或者打开 adobe 后 从文件创建 PDF 后，选 Word 文件即可）。Word 自带的导出和另存为大概率导出的 pdf 会比 Word 要大。

### 总结

以上方案只能说是手动，更好的当然是能直接一个操作然后实现以上步骤的自动执行。不过目前能力不足，只能到此。


 
